"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[730],{97308:function(Ot,X,d){d.r(X),d.d(X,{default:function(){return Lt}});var F=d(5574),L=d.n(F),H=d(1524),S=d(71577),g=d(67294),V=d(19632),k=d.n(V),W=d(75661),b=d(80854),P=d(96486),r=d(85893),$=function(){return(0,r.jsxs)("svg",{width:"100%",height:"100%",xmlns:"http://www.w3.org/2000/svg",style:{position:"relative",top:0,left:0},children:[(0,r.jsxs)("defs",{children:[(0,r.jsx)("pattern",{id:"smallGrid",width:"7.236328125",height:"7.236328125",patternUnits:"userSpaceOnUse",children:(0,r.jsx)("path",{d:"M 7.236328125 0 L 0 0 0 7.236328125",fill:"none",stroke:"rgba(207, 207, 207, 0.3)",strokeWidth:"1"})}),(0,r.jsxs)("pattern",{id:"grid",width:"36.181640625",height:"36.181640625",patternUnits:"userSpaceOnUse",children:[(0,r.jsx)("rect",{width:"36.181640625",height:"36.181640625",fill:"url(#smallGrid)"}),(0,r.jsx)("path",{d:"M 36.181640625 0 L 0 0 0 36.181640625",fill:"none",stroke:"rgba(186, 186, 186, 0.5)",strokeWidth:"1"})]})]}),(0,r.jsx)("rect",{width:"100%",height:"100%",fill:"url(#grid)"})]})},B=$,G=d(97857),C=d.n(G),U=d(82061),J=d(51042),K=d(52745),O=d(24556),Q=d(42075),q=["lt","t","rt","r","rb","b","lb","l"],_=function(t,a,n){var o=a/2,l=n/2,u={lt:[0,0],rt:[a,0],lb:[0,n],rb:[a,n],t:[o,0],b:[o,n],l:[0,Math.floor(l)],r:[a,Math.floor(l)]},s=u[t],i={lt:"nw-resize",t:"n-resize",rt:"ne-resize",r:"e-resize",rb:"se-resize",b:"s-resize",lb:"sw-resize",l:"w-resize"};return{marginLeft:"-4px",marginTop:"-4px",left:"".concat(s[0],"px"),top:"".concat(s[1],"px"),cursor:i[t]}};function tt(e,t){var a=e.width,n=e.height,o=e.top,l=o===void 0?0:o,u=e.left,s=u===void 0?0:u,i=Math.max(0,t.x),c=Math.max(0,t.y),f=s-i,v=l-c;e.width=a+f,e.height=n+v,e.top=c,e.left=i}function et(e,t,a){var n=e.height,o=e.top,l=e.left,u=l===void 0?0:l,s=Math.max(0,Math.min(a.width,t.x)),i=Math.max(0,t.y),c=s-u,f=o-i;e.width=c,e.height=n+f,e.top=i}function nt(e,t,a){var n=e.top,o=e.left,l=Math.max(0,Math.min(a.width,t.x)),u=Math.max(0,Math.min(a.height,t.y)),s=l-o,i=u-n;e.width=s,e.height=i}function rt(e,t,a){var n=e.width,o=e.top,l=e.left,u=Math.max(0,t.x),s=Math.max(0,Math.min(a.height,t.y)),i=l-u,c=s-o;e.width=n+i,e.height=c,e.left=u}function at(e,t){var a=e.height,n=e.top,o=n===void 0?0:n,l=Math.max(0,t.y),u=o-l;e.height=a+u,e.top=l}function it(e,t,a){var n=a.width;if(!(t.x>n)){var o=t.x-e.left;e.width=o}}function ot(e,t,a){var n=a.height;t.y>n||(e.height=t.y-e.top)}function st(e,t){var a=e.width,n=e.left;if(!(t.x<0)){var o=n-t.x;e.width=a+o,e.left=t.x}}function lt(e,t,a,n){switch(e){case"lt":return tt(t,a);case"t":return at(t,a);case"rt":return et(t,a,n);case"r":return it(t,a,n);case"rb":return nt(t,a,n);case"b":return ot(t,a,n);case"lb":return rt(t,a,n);case"l":return st(t,a);default:}}var ut=function(t){var a=t.children,n=t.element,o=t.editorClient,l=t.isEditState,u=n.style,s=(0,b.useModel)("scene.draganddrop.visualDragDemo.model",function(h){return{curComponent:h.curComponent,realtimeList:h.realtimeList,canvasStyle:h.canvasStyle,setRealtimeList:h.upRealtimeList,updateCurComponent:h.updateCurComponent,setCurComponent:h.upCurComponent}}),i=s.curComponent,c=s.realtimeList,f=s.canvasStyle,v=s.setRealtimeList,x=s.updateCurComponent,w=s.setCurComponent,A=(0,O.l)(function(){return{position:"absolute",outline:"1px solid #d9d9d9",".shape-point":{position:"absolute",background:"#fff",border:"1px solid #59c7f9",width:"8px",height:"8px",borderRadius:"50%",zIndex:1},"&.active":{outline:"1px solid #70c0ff",userSelect:"none"},"&:hover":{cursor:"move"}}}),St=function(m){m.stopPropagation(),w(n);var p=C()({},u),M={x:m.clientX,y:m.clientY},j={top:Number(p.top),left:Number(p.left)},T=function(R){var Z={x:R.clientX-M.x,y:R.clientY-M.y},Tt=f.height,Et=f.width,Rt=Z.x+j.left,bt=Z.y+j.top;p.left=Math.max(0,Math.min(Rt,Et-p.width)),p.top=Math.max(0,Math.min(bt,Tt-p.height)),x(n,p)},E=function y(){document.removeEventListener("mousemove",T),document.removeEventListener("mouseup",y)};document.addEventListener("mousemove",T),document.addEventListener("mouseup",E)},Dt=function(m,p){p.stopPropagation(),p.preventDefault();var M=C()({},u),j=function(y){var R={x:y.clientX-Math.round(o.left),y:y.clientY-Math.round(o.top)};lt(m,M,R,f),x(n,M)},T=function E(){document.removeEventListener("mousemove",j),document.removeEventListener("mouseup",E)};document.addEventListener("mousemove",j),document.addEventListener("mouseup",T)};return(0,r.jsxs)("div",{className:"".concat(A," ").concat(l&&(i==null?void 0:i.id)===n.id?"active":""),style:u,onMouseDown:function(m){l&&St(m)},children:[l&&(i==null?void 0:i.id)===n.id?(0,r.jsxs)(r.Fragment,{children:[q.map(function(h){return(0,r.jsx)("div",{className:"shape-point",style:_(h,u.width,u.height),onMouseDown:function(p){l&&Dt(h,p)}},h)}),(0,r.jsx)("div",{style:{position:"absolute",bottom:"-35px",right:"10px"},children:(0,r.jsxs)(Q.Z,{children:[(0,r.jsx)(S.ZP,{type:"primary",shape:"circle",icon:(0,r.jsx)(U.Z,{}),onClick:function(){var m=c.filter(function(p){return p.id!==(i==null?void 0:i.id)});v(m)}}),(0,r.jsx)(S.ZP,{type:"primary",shape:"circle",icon:(0,r.jsx)(J.Z,{}),onClick:function(){x(n,C()(C()({},n.style),{},{width:n.style.width+10}))}}),(0,r.jsx)(S.ZP,{type:"primary",shape:"circle",icon:(0,r.jsx)(K.Z,{}),onClick:function(){x(n,C()(C()({},n.style),{},{width:n.style.width-10}))}})]})})]}):null,a]})},N=ut,Y=d(5914),dt=d(84031),ct=function(t){var a=t.style,n=t.xAxis,o=t.yAxis,l=t.series,u=(0,g.useState)(!1),s=L()(u,2),i=s[0],c=s[1],f={grid:{top:50,right:8,bottom:24,left:36},xAxis:n,yAxis:o,series:l};return(0,r.jsxs)("div",{onDoubleClick:function(){c(!0)},children:[(0,r.jsx)(dt.Z,{option:f,style:{width:"".concat(a.width,"px"),height:"".concat(a.height,"px"),backgroundColor:"#fff"}}),(0,r.jsx)(Y.Z,{open:i,onCancel:function(){return c(!1)},onOk:function(){return c(!1)},children:"\u4FEE\u6539\u56FE\u8868\u914D\u7F6E...."})]})},ht=ct,ft=d(96365),vt=ft.Z.TextArea,pt=function(t){var a=t.style,n=(0,g.useRef)(null),o=(0,g.useState)("\u53CC\u51FB\u7F16\u8F91\u6587\u5B57"),l=L()(o,2),u=l[0],s=l[1],i=(0,g.useState)(!1),c=L()(i,2),f=c[0],v=c[1],x=(0,O.l)(function(){return{height:"24px",lineHeight:"24px",boxShadow:"0px 0px 6px 0px rgba(95, 109, 128, 0.16)",backgroundColor:"#fff",borderRadius:"3px",overflow:"hidden",padding:"5px 6px"}});return(0,r.jsxs)("div",{className:x,style:a,onDoubleClick:function(){v(!0)},children:[(0,r.jsx)("div",{ref:n,dangerouslySetInnerHTML:{__html:u}}),(0,r.jsx)(Y.Z,{open:f,onCancel:function(){return v(!1)},onOk:function(){return v(!1)},children:(0,r.jsx)(vt,{rows:4,value:u,onChange:function(A){s(A.target.value)}})})]})},xt=pt,D={TEXT:1,LINE_CHART:2},z=[{type:D.TEXT,label:"\u6587\u672C",style:{width:400,height:200,fontWeight:400,letterSpacing:0}},{type:D.LINE_CHART,label:"\u6298\u7EBF\u56FE",style:{width:600,height:300},xAxis:{type:"category",data:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]},yAxis:{type:"value"},series:[{data:[820,932,901,934,1290,1330,1320],type:"line",smooth:!0}]}];function I(e){switch(e.type){case D.TEXT:return(0,r.jsx)(xt,C()({},e));case D.LINE_CHART:return(0,r.jsx)(ht,C()({},e));default:return(0,r.jsx)(r.Fragment,{children:"\u672A\u77E5\u7EC4\u4EF6..."})}}var mt=function(){var t=(0,O.l)(function(){return{height:"100%",width:"100%",display:"flex",".list":{width:"80px",height:"40px",border:"1px solid #ddd",cursor:"grab",textAlign:"center",color:"#333",padding:"2px 5px",display:"flex",alignItems:"center",justifyContent:"center","&:hover":{cursor:"grabbing"}}}}),a=function(o){o.dataTransfer.setData("comType",o.target.dataset.type)};return(0,r.jsx)("div",{className:t,onDragStart:a,children:z.map(function(n,o){return(0,r.jsx)("div",{className:"list",draggable:!0,"data-index":o,"data-type":n.type,children:(0,r.jsx)("span",{children:n.label})},o)})})},gt=mt,Ct=function(){var t=(0,g.useRef)(null),a=(0,b.useModel)("scene.draganddrop.visualDragDemo.model",function(s){return{realtimeList:s.realtimeList,setRealtimeList:s.upRealtimeList,setCurComponent:s.upCurComponent,setCanvasStyle:s.upCanvasStyle}}),n=a.realtimeList,o=a.setRealtimeList,l=a.setCurComponent,u=a.setCanvasStyle;return(0,g.useEffect)(function(){t.current&&u({height:t.current.clientHeight,width:t.current.clientWidth})},[t]),window.addEventListener("resize",function(){t.current&&u({height:t.current.clientHeight,width:t.current.clientWidth})}),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{ref:t,style:{width:"95vw",height:"80vh",backgroundColor:"#fff"},onDragOver:function(i){i.preventDefault()},onDrop:function(i){var c;i.preventDefault(),i.stopPropagation();var f=+i.dataTransfer.getData("comType"),v=(c=t.current)===null||c===void 0?void 0:c.getBoundingClientRect();if(f&&v){var x=(0,P.cloneDeep)(z.find(function(w){return w.type===f}));if(!x)return;x.id=(0,W.x)(),x.style.top=i.clientY-v.y,x.style.left=i.clientX-v.x,x.style.zIndex=n.length+1,o([].concat(k()(n),[x]))}},onMouseDown:function(i){i.stopPropagation(),l(null)},children:[(0,r.jsx)(B,{}),n.map(function(s){var i;return(0,r.jsx)(N,{element:s,editorClient:(i=t.current)===null||i===void 0?void 0:i.getBoundingClientRect(),isEditState:!0,children:I(s)},s.id)})]}),(0,r.jsx)("div",{style:{position:"absolute",bottom:0,width:"100%"},children:(0,r.jsx)(gt,{})})]})},wt=Ct,Mt=function(t){console.log(t);var a=(0,b.useModel)("scene.draganddrop.visualDragDemo.model",function(l){return{realtimeList:l.realtimeList}}),n=a.realtimeList,o=(0,g.useRef)(null);return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("div",{style:{width:"95vw",height:"80vh",backgroundColor:"#fff"},children:n.map(function(l){var u;return(0,r.jsx)(N,{element:l,editorClient:(u=o.current)===null||u===void 0?void 0:u.getBoundingClientRect(),isEditState:!1,children:I(l)},l.id)})})})},jt=Mt,yt=function(){var t=(0,g.useState)(!1),a=L()(t,2),n=a[0],o=a[1];return(0,r.jsx)(H._z,{fixedHeader:!1,subTitle:(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(S.ZP,{type:"primary",size:"small",onClick:function(){o(!n)},children:n?"\u4FDD\u5B58":"\u7F16\u8F91"})}),children:n?(0,r.jsx)(wt,{}):(0,r.jsx)(jt,{})})},Lt=yt}}]);
