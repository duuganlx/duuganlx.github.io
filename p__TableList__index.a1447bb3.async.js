"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[325],{89938:function(e,a,s){s.r(a),s.d(a,{default:function(){return E}});var t=s(13769),r=s.n(t),n=s(5574),l=s.n(n),u=s(15009),d=s.n(u),i=s(97857),o=s.n(i),c=s(99289),p=s.n(c),g=s(2618),m=s(51042),f=s(1524),h=s(47490),x=s(2236),b=s(37476),M=s(5966),j=s(90672),v=s(92276),F=s(80854),T=s(45360),w=s(96365),y=s(71577),Z=s(85265),S=s(67294),k=s(38020),P=s(64317),C=s(86615),R=s(22452),q=s(5914),D=s(85893),I=function(e){var a=(0,F.useIntl)();return(0,D.jsxs)(k.L0,{stepsProps:{size:"small"},stepsFormRender:function(s,t){return(0,D.jsx)(q.Z,{width:640,bodyStyle:{padding:"32px 40px 48px"},destroyOnClose:!0,title:a.formatMessage({id:"pages.searchTable.updateForm.ruleConfig",defaultMessage:"规则配置"}),open:e.updateModalOpen,footer:t,onCancel:function(){e.onCancel()},children:s})},onFinish:e.onSubmit,children:[(0,D.jsxs)(k.L0.StepForm,{initialValues:{name:e.values.name,desc:e.values.desc},title:a.formatMessage({id:"pages.searchTable.updateForm.basicConfig",defaultMessage:"基本信息"}),children:[(0,D.jsx)(M.Z,{name:"name",label:a.formatMessage({id:"pages.searchTable.updateForm.ruleName.nameLabel",defaultMessage:"规则名称"}),width:"md",rules:[{required:!0,message:(0,D.jsx)(F.FormattedMessage,{id:"pages.searchTable.updateForm.ruleName.nameRules",defaultMessage:"请输入规则名称！"})}]}),(0,D.jsx)(j.Z,{name:"desc",width:"md",label:a.formatMessage({id:"pages.searchTable.updateForm.ruleDesc.descLabel",defaultMessage:"规则描述"}),placeholder:a.formatMessage({id:"pages.searchTable.updateForm.ruleDesc.descPlaceholder",defaultMessage:"请输入至少五个字符"}),rules:[{required:!0,message:(0,D.jsx)(F.FormattedMessage,{id:"pages.searchTable.updateForm.ruleDesc.descRules",defaultMessage:"请输入至少五个字符的规则描述！"}),min:5}]})]}),(0,D.jsxs)(k.L0.StepForm,{initialValues:{target:"0",template:"0"},title:a.formatMessage({id:"pages.searchTable.updateForm.ruleProps.title",defaultMessage:"配置规则属性"}),children:[(0,D.jsx)(P.Z,{name:"target",width:"md",label:a.formatMessage({id:"pages.searchTable.updateForm.object",defaultMessage:"监控对象"}),valueEnum:{0:"表一",1:"表二"}}),(0,D.jsx)(P.Z,{name:"template",width:"md",label:a.formatMessage({id:"pages.searchTable.updateForm.ruleProps.templateLabel",defaultMessage:"规则模板"}),valueEnum:{0:"规则模板一",1:"规则模板二"}}),(0,D.jsx)(C.Z.Group,{name:"type",label:a.formatMessage({id:"pages.searchTable.updateForm.ruleProps.typeLabel",defaultMessage:"规则类型"}),options:[{value:"0",label:"强"},{value:"1",label:"弱"}]})]}),(0,D.jsxs)(k.L0.StepForm,{initialValues:{type:"1",frequency:"month"},title:a.formatMessage({id:"pages.searchTable.updateForm.schedulingPeriod.title",defaultMessage:"设定调度周期"}),children:[(0,D.jsx)(R.Z,{name:"time",width:"md",label:a.formatMessage({id:"pages.searchTable.updateForm.schedulingPeriod.timeLabel",defaultMessage:"开始时间"}),rules:[{required:!0,message:(0,D.jsx)(F.FormattedMessage,{id:"pages.searchTable.updateForm.schedulingPeriod.timeRules",defaultMessage:"请选择开始时间！"})}]}),(0,D.jsx)(P.Z,{name:"frequency",label:a.formatMessage({id:"pages.searchTable.updateForm.object",defaultMessage:"监控对象"}),width:"md",valueEnum:{month:"月",week:"周"}})]})]})},L=["defaultRender"],N=function(){var e=p()(d()().mark((function e(a){var s;return d()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=T.ZP.loading("正在添加"),e.prev=1,e.next=4,(0,g.HP)(o()({},a));case 4:return s(),T.ZP.success("Added successfully"),e.abrupt("return",!0);case 9:return e.prev=9,e.t0=e.catch(1),s(),T.ZP.error("Adding failed, please try again!"),e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(a){return e.apply(this,arguments)}}(),A=function(){var e=p()(d()().mark((function e(a){var s;return d()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=T.ZP.loading("Configuring"),e.prev=1,e.next=4,(0,g.D7)({name:a.name,desc:a.desc,key:a.key});case 4:return s(),T.ZP.success("Configuration is successful"),e.abrupt("return",!0);case 9:return e.prev=9,e.t0=e.catch(1),s(),T.ZP.error("Configuration failed, please try again!"),e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(a){return e.apply(this,arguments)}}(),O=function(){var e=p()(d()().mark((function e(a){var s;return d()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=T.ZP.loading("正在删除"),a){e.next=3;break}return e.abrupt("return",!0);case 3:return e.prev=3,e.next=6,(0,g.DV)({key:a.map((function(e){return e.key}))});case 6:return s(),T.ZP.success("Deleted successfully and will refresh soon"),e.abrupt("return",!0);case 11:return e.prev=11,e.t0=e.catch(3),s(),T.ZP.error("Delete failed, please try again"),e.abrupt("return",!1);case 16:case"end":return e.stop()}}),e,null,[[3,11]])})));return function(a){return e.apply(this,arguments)}}(),E=function(){var e=(0,S.useState)(!1),a=l()(e,2),s=a[0],t=a[1],n=(0,S.useState)(!1),u=l()(n,2),i=u[0],c=u[1],T=(0,S.useState)(!1),k=l()(T,2),P=k[0],C=k[1],R=(0,S.useRef)(),q=(0,S.useState)(),E=l()(q,2),V=E[0],_=E[1],z=(0,S.useState)([]),B=l()(z,2),W=B[0],Y=B[1],G=(0,F.useIntl)(),H=[{title:(0,D.jsx)(F.FormattedMessage,{id:"pages.searchTable.updateForm.ruleName.nameLabel",defaultMessage:"Rule name"}),dataIndex:"name",tip:"The rule name is the unique key",render:function(e,a){return(0,D.jsx)("a",{onClick:function(){_(a),C(!0)},children:e})}},{title:(0,D.jsx)(F.FormattedMessage,{id:"pages.searchTable.titleDesc",defaultMessage:"Description"}),dataIndex:"desc",valueType:"textarea"},{title:(0,D.jsx)(F.FormattedMessage,{id:"pages.searchTable.titleCallNo",defaultMessage:"Number of service calls"}),dataIndex:"callNo",sorter:!0,hideInForm:!0,renderText:function(e){return"".concat(e).concat(G.formatMessage({id:"pages.searchTable.tenThousand",defaultMessage:" 万 "}))}},{title:(0,D.jsx)(F.FormattedMessage,{id:"pages.searchTable.titleStatus",defaultMessage:"Status"}),dataIndex:"status",hideInForm:!0,valueEnum:{0:{text:(0,D.jsx)(F.FormattedMessage,{id:"pages.searchTable.nameStatus.default",defaultMessage:"Shut down"}),status:"Default"},1:{text:(0,D.jsx)(F.FormattedMessage,{id:"pages.searchTable.nameStatus.running",defaultMessage:"Running"}),status:"Processing"},2:{text:(0,D.jsx)(F.FormattedMessage,{id:"pages.searchTable.nameStatus.online",defaultMessage:"Online"}),status:"Success"},3:{text:(0,D.jsx)(F.FormattedMessage,{id:"pages.searchTable.nameStatus.abnormal",defaultMessage:"Abnormal"}),status:"Error"}}},{title:(0,D.jsx)(F.FormattedMessage,{id:"pages.searchTable.titleUpdatedAt",defaultMessage:"Last scheduled time"}),sorter:!0,dataIndex:"updatedAt",valueType:"dateTime",renderFormItem:function(e,a,s){var t=a.defaultRender,n=r()(a,L),l=s.getFieldValue("status");return"0"!=="".concat(l)&&("3"==="".concat(l)?(0,D.jsx)(w.Z,o()(o()({},n),{},{placeholder:G.formatMessage({id:"pages.searchTable.exception",defaultMessage:"Please enter the reason for the exception!"})})):t(e))}},{title:(0,D.jsx)(F.FormattedMessage,{id:"pages.searchTable.titleOption",defaultMessage:"Operating"}),dataIndex:"option",valueType:"option",render:function(e,a){return[(0,D.jsx)("a",{onClick:function(){c(!0),_(a)},children:(0,D.jsx)(F.FormattedMessage,{id:"pages.searchTable.config",defaultMessage:"Configuration"})},"config"),(0,D.jsx)("a",{href:"https://procomponents.ant.design/",children:(0,D.jsx)(F.FormattedMessage,{id:"pages.searchTable.subscribeAlert",defaultMessage:"Subscribe to alerts"})},"subscribeAlert")]}}];return console.log("--1"),(0,g.jR)({current:1,pageSize:10}).then((function(e){console.log(e)})),(0,D.jsxs)(f._z,{children:[(0,D.jsx)(h.Z,{headerTitle:G.formatMessage({id:"pages.searchTable.title",defaultMessage:"Enquiry form"}),actionRef:R,rowKey:"key",search:{labelWidth:120},toolBarRender:function(){return[(0,D.jsxs)(y.ZP,{type:"primary",onClick:function(){t(!0)},children:[(0,D.jsx)(m.Z,{})," ",(0,D.jsx)(F.FormattedMessage,{id:"pages.searchTable.new",defaultMessage:"New"})]},"primary")]},request:g.jR,columns:H,rowSelection:{onChange:function(e,a){Y(a)}}}),(null==W?void 0:W.length)>0&&(0,D.jsxs)(x.S,{extra:(0,D.jsxs)("div",{children:[(0,D.jsx)(F.FormattedMessage,{id:"pages.searchTable.chosen",defaultMessage:"Chosen"})," ",(0,D.jsx)("a",{style:{fontWeight:600},children:W.length})," ",(0,D.jsx)(F.FormattedMessage,{id:"pages.searchTable.item",defaultMessage:"项"}),"  ",(0,D.jsxs)("span",{children:[(0,D.jsx)(F.FormattedMessage,{id:"pages.searchTable.totalServiceCalls",defaultMessage:"Total number of service calls"})," ",W.reduce((function(e,a){return e+a.callNo}),0)," ",(0,D.jsx)(F.FormattedMessage,{id:"pages.searchTable.tenThousand",defaultMessage:"万"})]})]}),children:[(0,D.jsx)(y.ZP,{onClick:p()(d()().mark((function e(){var a,s;return d()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O(W);case 2:Y([]),null===(a=R.current)||void 0===a||null===(s=a.reloadAndRest)||void 0===s||s.call(a);case 4:case"end":return e.stop()}}),e)}))),children:(0,D.jsx)(F.FormattedMessage,{id:"pages.searchTable.batchDeletion",defaultMessage:"Batch deletion"})}),(0,D.jsx)(y.ZP,{type:"primary",children:(0,D.jsx)(F.FormattedMessage,{id:"pages.searchTable.batchApproval",defaultMessage:"Batch approval"})})]}),(0,D.jsxs)(b.Y,{title:G.formatMessage({id:"pages.searchTable.createForm.newRule",defaultMessage:"New rule"}),width:"400px",open:s,onOpenChange:t,onFinish:function(){var e=p()(d()().mark((function e(a){return d()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N(a);case 2:e.sent&&(t(!1),R.current&&R.current.reload());case 4:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}(),children:[(0,D.jsx)(M.Z,{rules:[{required:!0,message:(0,D.jsx)(F.FormattedMessage,{id:"pages.searchTable.ruleName",defaultMessage:"Rule name is required"})}],width:"md",name:"name"}),(0,D.jsx)(j.Z,{width:"md",name:"desc"})]}),(0,D.jsx)(I,{onSubmit:function(){var e=p()(d()().mark((function e(a){return d()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A(a);case 2:e.sent&&(c(!1),_(void 0),R.current&&R.current.reload());case 4:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}(),onCancel:function(){c(!1),P||_(void 0)},updateModalOpen:i,values:V||{}}),(0,D.jsx)(Z.Z,{width:600,open:P,onClose:function(){_(void 0),C(!1)},closable:!1,children:(null==V?void 0:V.name)&&(0,D.jsx)(v.vY,{column:2,title:null==V?void 0:V.name,request:p()(d()().mark((function e(){return d()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{data:V||{}});case 1:case"end":return e.stop()}}),e)}))),params:{id:null==V?void 0:V.name},columns:H})})]})}}}]);